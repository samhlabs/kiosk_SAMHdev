!function(e){window.debiki||(window.debiki={}),debiki.Utterscroll||(debiki.Utterscroll={}),debiki.Utterscroll=function(){function o(o){function r(o,t){if(t>6)return!1;var n=o.contents().filter(function(o,n){if(3===n.nodeType){var i=n.data.match(/^\s*$/);return!i}if(8===n.nodeType)return!1;var l=e(n);if("inline"===l.css("display")){var s=r(l,t+1);return s}// click the <html> elem!)
return!1});return n.length>0}if(l&&1===o.which){var i=e(o.target),u=i.closest(c);if(!(u.length>0)){var d=m.offset();if(d){if(o.pageX>d.left+m.width())return s.onMousedownOnWinVtclScrollbar(),void 0;if(o.pageY>d.top+m.height())return s.onMousedownOnWinHztlScrollbar(),void 0;// trigger onmouseup". (Also mousemove won't happen!)
if("auto"===i.css("overflow")||"scroll"===i.css("overflow")){var p=e('<div style="width: 100%; height: 100%; position: absolute;"></div>');p.css({top:i.scrollTop(),left:i.scrollLeft()});var v=i.css("position");"static"===v&&i.css("position","relative"),i.prepend(p);var h=!1;if(o.pageX>p.offset().left+p.width()&&(h=!0),o.pageY>p.offset().top+p.height()&&(h=!0),"static"===v&&(i.css("position",v),f('Consider using "position: relative" for element #'+(i[0].id?i[0].id:"?")+", which has scrollbars, because otherwise the scrollbars might not work in Firefox in combination with Utterscroll.")),p.remove(),h)return}a=e.expr[":"].scrollable?i.closest(":scrollable:not(html, body)").add(e(window)).first():e(window);var b=r(i,0);if(f(o.target.nodeName+" containsText: "+b),!b)return n(o);var y=t(i,o);return f("Approx dist from $target text to mouse: "+y),-1===y||y>55?n(o):void 0}}}}function t(o,t){var n=o,r=n.html(),i='<span class="utrscrlhlpr"/>',l=[],s=r.replace(/<[^>]*>/g,function(e){return l.push(e),"·"}),c=i+s.replace(/(\s*.{0,2})/g,"$1"+i),a=0,u=c.replace(/·/g,function(){return a+=1,l[a-1]}),d=n.clone();d.html(u),d.insertBefore(n);var f;if(t.pageX||t.pageY)f={x:t.pageX,y:t.pageY};else{var p=document;f={x:t.clientX+p.body.scrollLeft+p.documentElement.scrollLeft,y:t.clientY+p.body.scrollTop+p.documentElement.scrollTop}}var v=999999999;return d.find(".utrscrlhlpr").each(function(){var o=e(this).offset(),t=f.x-o.left,n=f.y-o.top,r=t*t+n*n;v>r&&(v=r)}),d.remove(),Math.sqrt(v)}function n(o){return e(document).mousemove(r),e(document).mouseup(i),e(document.body).css("cursor","move"),u={x:o.clientX,y:o.clientY},d={x:o.clientX,y:o.clientY},!1}function r(o){var t={x:Math.abs(o.clientX-u.x),y:Math.abs(o.clientY-u.y)},n={x:o.clientX-d.x,y:o.clientY-d.y};a[0]===window||("hidden"===a.css("overflow-y")&&(n.y=0),"hidden"===a.css("overflow-x")&&(n.x=0)),!v&&t.x*t.x+t.y*t.y>h*h&&(v=!0,s.onHasUtterscrolled());// slowly (unbearably slowly if there're lots of SVG arrows!) and
var r;return t.x>9&&(r=Math.log((t.x-9)/3),r>1.7&&e.browser&&e.browser.opera&&(r=1.7),r>1&&(n.x*=r)),t.y>5&&(r=Math.log((t.y-5)/2),r>1.3&&e.browser&&e.browser.opera&&(r=1.3),r>1&&(n.y*=r)),a.scrollLeft(a.scrollLeft()-n.x),a.scrollTop(a.scrollTop()-n.y),d={x:o.clientX,y:o.clientY},!1}function i(){return a=void 0,u=void 0,d=void 0,e(document.body).css("cursor",""),e.event.remove(document,"mousemove",r),e.event.remove(document,"mouseup",i),!1}var l,s,c,a,u,d,f="undefined"!=typeof console&&console.debug?function(){console.debug.apply(console,arguments)}:function(){},p={defaultScrollstoppers:"a, area, button, command, input, keygen, label, option, select, textarea, video",scrollstoppers:"",onMousedownOnWinVtclScrollbar:function(){},onMousedownOnWinHztlScrollbar:function(){},onHasUtterscrolled:function(){}},v=!1,h=15,m=e('<div style="width: 100%; height: 100%; position: fixed; top: 0; left: 0; z-index: -999"></div>').appendTo(document.body);e(document).mousedown(o);var b={enable:function(o){l=!0,(o||!s)&&(s=e.extend({},p,o),c=s.defaultScrollstoppers,s.scrollstoppers.length>0&&(c+=", "+o.scrollstoppers))},disable:function(){l=!1},isEnabled:function(){return l},isScrolling:function(){return!!u}};return b}()}(jQuery);